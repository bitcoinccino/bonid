<%= render "shared/navbar" %>
<%= render "shared/flash" %>
<div style="padding-top: 50px;"></div>

<header class="hero-section bg-light py-5" role="banner">
  <div class="container text-center">
    <div class="d-flex justify-content-center align-items-center mb-3">
      <h1 class="display-4 fw-bold text-primary mb-0">BonID</h1>
    </div>
    <p class="lead text-dark mb-4">Verify your identity in minutes â€” trusted across Haiti</p>

    <div class="d-flex justify-content-center flex-wrap gap-3">
      <% unless current_user&.admin? %>
        <%= link_to "Get Verified Now", user_dashboard_path,
                    class: "btn btn-success btn-lg px-5 fw-semibold rounded-3",
                    aria_label: "Start your identity verification" %>
      <% end %>

      <%= link_to "Learn More", "#how-it-works",
                  class: "btn btn-outline-primary btn-lg px-5 fw-semibold rounded-3",
                  aria_label: "Learn how BonID works" %>
    </div>
  </div>
</header>

<!-- How It Works -->
<section id="how-it-works" class="container py-5" role="main">
  <h2 class="h4 fw-bold text-primary text-center mb-5">How BonID Works</h2>
  <div class="row g-4">
    <div class="col-md-4">
      <div class="card shadow-sm rounded-3 h-100 hover-card">
        <div class="card-body text-center p-4">
          <i class="ri-upload-cloud-2-line text-primary" style="font-size: 2.5rem;" aria-hidden="true"></i>
          <h5 class="fw-semibold mt-3">1. Submit Documents</h5>
          <p class="text-muted">Upload your CIN, passport, selfie, and proof of address securely.</p>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card shadow-sm rounded-3 h-100 hover-card">
        <div class="card-body text-center p-4">
          <i class="ri-shield-check-line text-primary" style="font-size: 2.5rem;" aria-hidden="true"></i>
          <h5 class="fw-semibold mt-3">2. Verification by Admin</h5>
          <p class="text-muted">Our team reviews submissions and approves valid identities.</p>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card shadow-sm rounded-3 h-100 hover-card">
        <div class="card-body text-center p-4">
          <i class="ri-qr-code-line legend-color text-primary" style="font-size: 2.5rem;" aria-hidden="true"></i>
          <h5 class="fw-semibold mt-3">3. Reusable Digital ID</h5>
          <p class="text-muted">Use your verified BonID QR code for banks, schools, and more.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="text-center mt-5">
    <%= link_to "Start Now", user_dashboard_path, class: "btn btn-primary btn-lg px-5 fw-semibold rounded-3", aria_label: "Begin verification process" %>
  </div>
</section>

<div class="text-center mt-4">
  <%= link_to "See All Partners", partners_path, class: "btn btn-outline-secondary rounded-pill fw-semibold" %>
</div>


  <div style="padding-top: 50px;"></div>

<%= render "shared/footer" %>


<!-- Custom CSS -->
<style>
  /* Reset browser defaults */
  html, body {
    margin: 0 !important;
    padding: 0 !important;
    width: 100%;
    overflow-x: hidden;
  }

  /* Sticky footer and full-width styles */
  body {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }

  .main-content {
    flex: 1 0 auto;
    width: 100%;
  }


  .container-fluid {
    padding-left: 15px !important;
    padding-right: 15px !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    width: 100% !important;
  }

  /* BonID Styles */
  .bg-light {
    background-color: #F8F9FA !important; /* Light Gray */
  }

  .text-primary {
    color: #3366CC !important; /* Ocean Blue */
  }

  .text-muted {
    color: #6C757D !important; /* Mid Gray */
  }

  .btn-primary {
    background-color: #00209F; /* Haitian Blue */
    border-color: #00209F;
    color: #FFFFFF;
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    transition: background-color 0.3s ease, border-color 0.3s ease;
  }

  .btn-primary:hover {
    background-color: #001A80; /* Darker Haitian Blue */
    border-color: #001A80;
  }

  .btn-success {
    background-color: #1A936F; /* Palm Green */
    border-color: #1A936F;
    color: #FFFFFF;
    padding: 0.75rem 2rem;
    border-radius: 0.5rem;
    transition: background-color 0.3s ease, border-color 0.3s ease;
  }

  .btn-success:hover {
    background-color: #157A5C; /* Darker Palm Green */
    border-color: #157A5C;
  }

  .form-control {
    border: 1px solid #6C757D; /* Mid Gray */
    border-radius: 0.5rem;
    font-size: 0.9rem;
    padding: 0.5rem 0.75rem;
  }

  .form-control:focus {
    border-color: #3366CC; /* Ocean Blue */
    box-shadow: 0 0 0 0.2rem rgba(51, 102, 204, 0.25);
  }

  .card {
    background-color: #FFFFFF; /* Pure White */
    border: 1px solid #F8F9FA; /* Light Gray */
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .hover-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
  }

  .hero-section {
    background-color: #F8F9FA; /* Light Gray */
    min-height: 60vh;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .logo-img {
    max-width: 60px;
    height: auto;
  }
   .card-img-top {
  max-height: 150px;
  object-fit: contain;
}


  /* Tooltip styles */
  .tooltip-inner {
    background-color: #343A40; /* Dark Gray */
    color: #FFFFFF;
    border-radius: 0.5rem;
  }

  .tooltip.bs-tooltip-top .tooltip-arrow::before {
    border-top-color: #343A40;
  }

  /* Responsive adjustments */
  @media (max-width: 576px) {
    .hero-section {
      min-height: 50vh;
      padding: 3rem 0;
    }
    .display-4 {
      font-size: 2rem;
    }
    .lead {
      font-size: 1rem;
    }
    .btn-lg {
      font-size: 0.9rem;
      padding: 0.5rem 1.5rem;
    }
    .card {
      margin-bottom: 1rem;
    }
    .form-control {
      font-size: 0.85rem;
      padding: 0.4rem 0.6rem;
    }
    h2 {
      font-size: 1.5rem;
    }
    h5, h6 {
      font-size: 1.1rem;
    }
    .logo-img {
      max-width: 40px;
    }
    .text-muted {
      font-size: 0.8rem;
    }
  }
</style>

<!-- JavaScript for Tooltips -->

<script>


  document.getElementById('partner-form').addEventListener('submit', function(e) {
  const email = document.querySelector('input[type="email"]').value;
  if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
    e.preventDefault();
    alert('Please enter a valid email address.');
  }
});


  document.addEventListener('DOMContentLoaded', function() {
    // Initialize Tooltips
    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
    tooltipTriggerList.forEach(tooltipTriggerEl => {
      new bootstrap.Tooltip(tooltipTriggerEl);
    });

    // Form Bot Prevention and Validation
    const form = document.getElementById('partner-form');
    if (form) {
      const emailInput = form.querySelector('input[type="email"]');
      const useCasesSelect = form.querySelector('select[name="use_cases[]"]');
      const departmentSectorSelect = form.querySelector('select[name="department_sector"]');
      const websiteInput = form.querySelector('input[name="website"]');
      const humanTokenInput = document.querySelector('#human-token');
      const formSubmissionTime = Date.now();

      // Set human token after 3 seconds to ensure human interaction
      setTimeout(() => {
        humanTokenInput.value = 'human_' + Math.random().toString(36).substr(2, 9);
      }, 3000);

      form.addEventListener('submit', function(e) {
        // Check honeypot field
        if (websiteInput.value !== '') {
          e.preventDefault();
          console.log('Bot detected: Honeypot field filled');
          return;
        }

        // Check submission speed (too fast indicates bot)
        if (Date.now() - formSubmissionTime < 2000) {
          e.preventDefault();
          alert('Form submitted too quickly. Please try again.');
          return;
        }

        // Check human token
        if (!humanTokenInput.value.startsWith('human_')) {
          e.preventDefault();
          alert('Please wait a moment before submitting.');
          return;
        }

        // Validate email
        if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailInput.value)) {
          e.preventDefault();
          alert('Please enter a valid email address.');
          return;
        }

        // Validate use cases
        if (!useCasesSelect.value || useCasesSelect.selectedOptions.length === 0) {
          e.preventDefault();
          alert('Please select at least one use case.');
          return;
        }

        // Validate department sector
        if (!departmentSectorSelect.value) {
          e.preventDefault();
          alert('Please select a department sector.');
          return;
        }
      });
    }

    // Cookie Consent Logic
    const cookieBanner = document.getElementById('cookie-consent-banner');
    const acceptAllBtn = document.getElementById('acceptAllCookies');
    const manageSettingsBtn = document.getElementById('manageCookieSettings');
    const savePreferencesBtn = document.getElementById('saveCookiePreferences');
    const analyticsCheckbox = document.getElementById('analyticsCookies');
    const marketingCheckbox = document.getElementById('marketingCookies');

    if (cookieBanner) {
      if (localStorage.getItem('cookieConsent')) {
        cookieBanner.style.display = 'none';
        loadScripts();
      } else {
        cookieBanner.style.display = 'block';
      }

      acceptAllBtn.addEventListener('click', function() {
        localStorage.setItem('cookieConsent', JSON.stringify({
          functional: true,
          analytics: true,
          marketing: true
        }));
        cookieBanner.style.display = 'none';
        loadScripts();
      });

      savePreferencesBtn.addEventListener('click', function() {
        const consent = {
          functional: true,
          analytics: analyticsCheckbox.checked,
          marketing: marketingCheckbox.checked
        };
        localStorage.setItem('cookieConsent', JSON.stringify(consent));
        cookieBanner.style.display = 'none';
        loadScripts();
        bootstrap.Modal.getInstance(document.getElementById('cookieSettingsModal')).hide();
      });

      function loadScripts() {
        const consent = JSON.parse(localStorage.getItem('cookieConsent') || '{}');
        if (consent.analytics) {
          const script = document.createElement('script');
          script.src = 'https://www.googletagmanager.com/gtag/js?id=YOUR_GA_ID';
          document.head.appendChild(script);
        }
        if (consent.marketing) {
          console.log('Loading marketing scripts...');
        }
      }
    }
  });
</script>

<!-- reCAPTCHA Script (Optional) -->
<% if Rails.env.production? %>
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
<% end %>